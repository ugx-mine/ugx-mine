<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>UGX Mining Platform</title>
<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#10b981">
<link rel="apple-touch-icon" href="icon-192.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<!-- CDN -->
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.42.0"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://www.youtube.com/iframe_api"></script>
<style>
/* üåå ANIMATED BACKGROUND */
.fixed-bg {
position: fixed;
inset: 0;
z-index: -10;
overflow: hidden;
}
.fixed-bg .radial {
position: absolute;
top: -50%;
left: -50%;
width: 200%;
height: 200%;
background: radial-gradient(circle at 50% 50%, rgba(16, 185, 129, 0.08), transparent 60%);
animation: pulse-slow 8s ease-in-out infinite;
}
.fixed-bg .conic {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: conic-gradient(from 0deg, transparent 0%, #10b981 10%, transparent 20%, #3b82f6 30%, transparent 40%, #f59e0b 50%, transparent 60%);
opacity: 0.05;
animation: rotate-slow 120s linear infinite;
}
@keyframes rotate-slow {
from { transform: rotate(0deg); }
to { transform: rotate(360deg); }
}
@keyframes pulse-slow {
0%, 100% { opacity: 0.05; }
50% { opacity: 0.12; }
}
/* üñ•Ô∏è BASE STYLES */
body {
background-color: #f3f4f6;
color: #1f2937;
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
min-height: 100dvh;
-webkit-tap-highlight-color: transparent;
touch-action: manipulation;
transition: background-color 0.4s ease, color 0.4s ease;
}
button {
-webkit-appearance: none;
-moz-appearance: none;
appearance: none;
}
#authCard {
-webkit-overflow-scrolling: touch;
touch-action: manipulation;
pointer-events: auto !important;
}
#authCard * {
pointer-events: auto;
}
/* ü™û GLASS CARDS */
.mining-card {
background: rgba(255, 255, 255, 0.75);
backdrop-filter: blur(12px);
-webkit-backdrop-filter: blur(12px);
border: 1px solid rgba(16, 185, 129, 0.2);
border-radius: 16px;
padding: 1.25rem;
margin-bottom: 1.25rem;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
position: relative;
overflow: hidden;
}
.mining-card::before {
content: '';
position: absolute;
top: -2px;
left: -2px;
right: -2px;
bottom: -2px;
background: linear-gradient(45deg, #10b981, #3b82f6, #f59e0b, #10b981);
background-size: 400%;
z-index: -1;
border-radius: 18px;
opacity: 0;
transition: opacity 0.4s;
}
.mining-card:hover::before {
opacity: 1;
}
.mining-card:hover {
transform: translateY(-4px);
box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
}
/* üî∑ BOOSTER CARDS */
.booster-card {
background: rgba(240, 249, 255, 0.6);
backdrop-filter: blur(10px);
border: 1px solid rgba(59, 130, 246, 0.3);
border-radius: 16px;
padding: 1.25rem;
transition: all 0.3s ease;
position: relative;
overflow: hidden;
}
.booster-card:hover {
background: rgba(226, 232, 240, 0.8);
transform: translateY(-6px);
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
}
/* üîò TABS */
.auth-tab {
padding: 0.5rem 1rem;
cursor: pointer;
border-radius: 0.5rem;
font-weight: 600;
color: #4b5563;
}
.auth-tab.active {
background: rgba(16, 185, 129, 0.15);
color: #10b981;
}
/* ‚ú® PULSE ANIMATION */
@keyframes pulse-glow {
0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
50% { box-shadow: 0 0 0 12px rgba(16, 185, 129, 0); }
}
.animate-pulse-glow {
animation: pulse-glow 2s infinite;
}
/* üì± BOTTOM NAV */
#bottomNav {
background: rgba(255, 255, 255, 0.85);
backdrop-filter: blur(10px);
-webkit-backdrop-filter: blur(10px);
border-top: 1px solid rgba(229, 231, 235, 0.7);
position: fixed;
bottom: 0;
left: 0;
right: 0;
z-index: 40;
}
#bottomNav button {
color: #6b7280;
font-size: 0.75rem;
}
#bottomNav button.active, #bottomNav button:hover {
color: #10b981;
}
/* THEME TOGGLE SWITCH */
.theme-toggle {
display: flex;
align-items: center;
justify-content: center;
background-color: #e5e7eb;
border-radius: 9999px;
padding: 2px;
width: 80px;
height: 24px;
cursor: pointer;
transition: background-color 0.3s ease;
}
.theme-toggle input {
display: none;
}
.theme-toggle .toggle-thumb {
height: 20px;
width: 20px;
background-color: white;
border-radius: 50%;
box-shadow: 0 1px 2px rgba(0,0,0,0.2);
transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.theme-toggle input:checked + .toggle-thumb {
transform: translateX(56px);
background-color: #4b5563;
}
/* DARK MODE STYLES */
body.dark-mode {
background-color: #111827;
color: #e5e7eb;
}
body.dark-mode .mining-card,
body.dark-mode .booster-card {
background: rgba(31, 41, 55, 0.8);
color: #f9fafb;
border-color: rgba(79, 70, 229, 0.3);
}
body.dark-mode #authCard .bg-white {
background-color: #1f2937 !important;
color: #e5e7eb;
}
body.dark-mode #bottomNav {
background: rgba(17, 24, 39, 0.85);
border-top-color: rgba(55, 65, 81, 0.7);
}
body.dark-mode #bottomNav button {
color: #9ca3af;
}
body.dark-mode #bottomNav button.active,
body.dark-mode #bottomNav button:hover {
color: #60a5fa;
}
body.dark-mode .auth-tab {
color: #d1d5db;
}
body.dark-mode .auth-tab.active {
background: rgba(96, 165, 250, 0.15);
color: #60a5fa;
}
body.dark-mode input,
body.dark-mode select,
body.dark-mode textarea {
background-color: #1f2937;
color: #f9fafb;
border-color: #374151;
}
/* ANIMATIONS FOR ICONS */
#nextClaimAmount .fa-coins {
animation: shimmer 3s infinite;
}
#miningStatus .fa-bolt {
animation: pulse-booster 2s infinite;
}
@keyframes shimmer {
0%, 100% { opacity: 0.9; transform: translateY(0); }
50% { opacity: 1; transform: translateY(-2px); }
}
@keyframes pulse-booster {
0%, 100% { opacity: 1; transform: scale(1); }
50% { opacity: 0.8; transform: scale(1.1); }
}
/* OTHER */
.loading-btn {
opacity: 0.75;
cursor: not-allowed;
}
.tab-content { display: none; }
.tab-content.active { display: block; }
/* == WHEEL GAME STYLES == */
.wheel-wrapper { position: relative; margin: 10px 0; }
.pointer {
position: absolute; top: -10px; left: 50%; transform: translateX(-50%);
width: 0; height: 0; border-left: 15px solid transparent;
border-right: 15px solid transparent; border-top: 25px solid #ffffff; z-index: 10;
}
#wheel { border-radius: 50%; border: 10px solid #959494; transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); }
/* FADE-IN/OUT ANIMATION FOR POPUP */
@keyframes fadeInOut {
0%   { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
20%  { opacity: 1; transform: translate(-50%, -50%) scale(1); }
80%  { opacity: 1; transform: translate(-50%, -50%) scale(1); }
100% { opacity: 0; transform: translate(-50%, -50%) scale(1.1); }
}
/* ‚úÖ NEW: CENTERING STYLES */
.wheel-game-container {
display: flex;
flex-direction: column;
align-items: center;
width: 100%;
gap: 1.25rem;
}
.stake-panel-centered {
width: 100%;
max-width: 24rem; /* ~xs size */
}
</style>
</head>
<body>
<!-- üåå ANIMATED BACKGROUND -->
<div class="fixed-bg">
<div class="radial"></div>
<div class="conic"></div>
</div>
<!-- Auth Modal -->
<div id="authCard" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center">
<div class="bg-white rounded-xl p-6 w-full max-w-md shadow-2xl">
<div class="flex mb-4 bg-gray-100 rounded-lg p-1">
<div id="tabSignup" class="auth-tab active flex-1 text-center">Sign Up</div>
<div id="tabLogin" class="auth-tab flex-1 text-center">Login</div>
</div>
<form id="signupForm" class="space-y-4">
<input type="text" id="signupUsername" placeholder="Username" class="w-full bg-gray-50 rounded-lg px-4 py-2 border border-gray-300" required>
<input type="email" id="signupEmail" placeholder="Email" class="w-full bg-gray-50 rounded-lg px-4 py-2 border border-gray-300" required>
<input type="password" id="signupPassword" placeholder="Password" class="w-full bg-gray-50 rounded-lg px-4 py-2 border border-gray-300" required>
<button type="submit" class="w-full bg-emerald-600 hover:bg-emerald-700 py-2 rounded-lg text-white font-bold">Create Account</button>
</form>
<form id="loginForm" class="hidden space-y-4">
<input type="text" id="loginUsername" placeholder="Username" class="w-full bg-gray-50 rounded-lg px-4 py-2 border border-gray-300" required>
<input type="password" id="loginPassword" placeholder="Password" class="w-full bg-gray-50 rounded-lg px-4 py-2 border border-gray-300" required>
<a href="mailto:auraaimoney@gmail.com" class="text-xs text-gray-500 hover:text-gray-700 block text-center">Forgot password? Contact admin</a>
<button type="submit" class="w-full bg-emerald-600 hover:bg-emerald-700 py-2 rounded-lg text-white font-bold">Login</button>
</form>
</div>
</div>
<!-- ‚úÖ DEPOSIT INPUT MODAL -->
<div id="depositInputModal" class="fixed inset-0 bg-black/80 flex items-center justify-center hidden z-50">
<div class="bg-white p-6 rounded-xl w-96">
<h3 class="text-lg font-bold mb-4">Enter Deposit Amount</h3>
<p class="text-xs text-gray-600 mb-3">Minimum deposit: <strong>10,000 UGX</strong></p>
<div class="mb-3">
<label class="block text-xs text-gray-600 mb-1">Amount (UGX)</label>
<input
type="number"
id="depositAmountInput"
placeholder="e.g. 10000"
class="w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 text-sm"
min="10000"
>
<p id="depositAmountUSDT" class="text-xs text-gray-500 mt-1">~0.00 USDT</p>
</div>
<div class="flex gap-2">
<button id="confirmDepositBtn" onclick="confirmDepositAmount()" class="flex-1 bg-emerald-600 py-2 rounded text-white text-sm font-medium">Continue</button>
<button onclick="document.getElementById('depositInputModal').classList.add('hidden')" class="flex-1 bg-gray-300 py-2 rounded text-sm">Cancel</button>
</div>
</div>
</div>
<!-- Main App (initially hidden) -->
<div id="mainApp" class="hidden">
<div class="container mx-auto px-4 pb-[72px] pt-4">
<!-- ‚úÖ STICKY HEADER -->
<header class="flex justify-between items-center mb-5 py-2 bg-white/90 backdrop-blur-sm sticky top-0 z-30 rounded-lg shadow-sm">
<div class="flex items-center space-x-2.5">
<div class="bg-emerald-500 p-1.5 rounded-lg"><i class="fas fa-coins text-lg text-white"></i></div>
<h1 class="text-xl font-bold tracking-tight">UGX<span class="text-gray-800">Mine</span></h1>
</div>
<div class="flex gap-1.5">
<button class="p-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700">
<i class="fas fa-bell text-sm"></i>
</button>
<button id="authToggle" class="p-1.5 bg-red-500 hover:bg-red-600 rounded-lg text-white">
<i class="fas fa-power-off text-sm"></i>
</button>
</div>
</header>
<!-- DASHBOARD -->
<main id="mainContent">
<!-- HOME -->
<section id="tab-home" class="tab-content active">
<div class="mining-card flex justify-between items-center">
<div>
<h2 id="profileUserName" class="text-lg font-bold">---</h2>
<p id="profileUserEmail" class="text-gray-600 text-sm">---</p>
<p id="profileUserId" class="text-gray-500 text-xs">ID: ---</p>
</div>
<button id="editProfileBtn" class="border border-emerald-500 text-emerald-500 px-3 py-1 rounded text-xs font-medium">Set Wallet</button>
</div>
<!-- ‚úÖ TOTAL BALANCE CARD -->
<div class="mining-card w-full max-w-3xl text-center mb-5">
<p class="font-bold text-amber-600 mb-2">Total Balance</p>
<p id="totalBalance" class="text-3xl font-bold text-amber-700">0 UGX</p>
<p id="totalBalanceUSDT" class="text-sm text-gray-600">~0.00 USDT</p>
<div class="grid grid-cols-2 gap-3 mt-4">
<button onclick="showDepositInput()" class="bg-amber-500 hover:bg-amber-600 py-2 rounded text-sm text-white font-medium">Deposit</button>
<button onclick="openWithdrawModal()" class="bg-emerald-500 hover:bg-emerald-600 py-2 rounded text-sm text-white font-medium">Withdraw (20% fee)</button>
</div>
</div>
<!-- ‚úÖ NEXT CLAIM & MINING STATUS -->
<div class="flex justify-between items-center mt-4 pt-3 border-t border-gray-200 text-sm">
<div>
<p class="text-xs text-gray-600">Next Claim</p>
<p id="nextClaimAmount" class="font-bold text-emerald-700"><i class="fas fa-coins text-emerald-500 mr-1"></i>5,000 UGX</p>
</div>
<div class="text-right">
<p class="text-xs text-gray-600">Mining Status</p>
<p id="miningStatus" class="font-bold"><i class="fas fa-bolt text-amber-500 mr-1"></i>Default 24h cycle</p>
</div>
</div>
<!-- ‚úÖ CENTERED CLAIM BUTTON -->
<div class="flex justify-center my-4">
<button id="miningBtn" class="w-full max-w-xs bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 py-2.5 rounded-lg font-bold text-white shadow-lg transition animate-pulse-glow">
Claim Funds
</button>
</div>
<!-- ‚úÖ BOOSTERS (CLAIM ENHANCERS) -->
<div class="mining-card mb-5">
<h3 class="font-bold text-gray-900 mb-3 text-center">Boosters</h3>
<div class="grid grid-cols-1 md:grid-cols-3 gap-3">
<div class="booster-card">
<h4 class="font-bold text-sm text-blue-700">Eager_Miner</h4>
<p class="text-xl font-bold text-blue-600 my-1">2h cycle</p>
<p class="font-bold text-emerald-600 text-xs mt-1">+2,000 UGX / claim</p>
<p class="text-xs text-gray-600 mt-1">Price: <span id="priceEagle">‚Äî</span></p>
<button onclick="openBoosterModal('eagle', 2, 2000)" class="w-full mt-2 bg-blue-600 hover:bg-blue-700 py-2 rounded text-xs text-white">Buy</button>
</div>
<div class="booster-card">
<h4 class="font-bold text-sm text-purple-700">Falcon_Miner</h4>
<p class="text-xl font-bold text-purple-600 my-1">2h cycle</p>
<p class="font-bold text-emerald-600 text-xs mt-1">+5,000 UGX / claim</p>
<p class="text-xs text-gray-600 mt-1">Price: <span id="priceFalcon">‚Äî</span></p>
<button onclick="openBoosterModal('falcon', 2, 5000)" class="w-full mt-2 bg-purple-600 hover:bg-purple-700 py-2 rounded text-xs text-white">Buy</button>
</div>
<div class="booster-card">
<h4 class="font-bold text-sm text-amber-700">Phoenix_Miner</h4>
<p class="text-xl font-bold text-amber-600 my-1">2h cycle</p>
<p class="font-bold text-emerald-600 text-xs mt-1">+10,000 UGX / claim</p>
<p class="text-xs text-gray-600 mt-1">Price: <span id="pricePhoenix">‚Äî</span></p>
<button onclick="openBoosterModal('phoenix', 2, 10000)" class="w-full mt-2 bg-amber-600 hover:bg-amber-700 py-2 rounded text-xs text-white">Buy</button>
</div>
</div>
</div>
<!-- FOMO: Booster Buyers -->
<div class="mining-card mt-4">
<h3 class="font-bold text-gray-900 mb-2 text-center">üî• Live Booster Activity</h3>
<div id="fomoBoosterFeed" class="text-xs space-y-1 max-h-24 overflow-hidden"></div>
</div>
<!-- FOMO: Deposits & Withdrawals -->
<div class="mining-card mt-4">
<h3 class="font-bold text-gray-900 mb-2 text-center">üí∏ Recent Transactions</h3>
<div id="fomoTxFeed" class="text-xs space-y-1 max-h-24 overflow-hidden"></div>
</div>
<!-- INVITE -->
<div class="mining-card">
<h3 class="font-bold text-gray-900 mb-2">Invite Friends</h3>
<p class="text-xs text-gray-600 mb-2">+5,000 UGX per friend (max 2)</p>
<div class="flex items-center bg-gray-50 p-1.5 rounded">
<input type="text" id="refLink" class="bg-transparent flex-1 text-xs" readonly>
<button onclick="copyRefLink()" class="text-emerald-600 ml-2 text-xs font-medium">Copy</button>
</div>
</div>
</section>
<!-- INVESTMENTS -->
<section id="tab-investments" class="tab-content">
<!-- ‚úÖ TOTAL BALANCE CARD -->
<div class="mining-card w-full max-w-3xl text-center mb-5">
<p class="font-bold text-amber-600 mb-2">Total Balance</p>
<p id="investTotalBalance" class="text-3xl font-bold text-amber-700">0 UGX</p>
<p id="investTotalBalanceUSDT" class="text-sm text-gray-600">~0.00 USDT</p>
<div class="grid grid-cols-2 gap-3 mt-4">
<button onclick="showDepositInput()" class="bg-amber-500 hover:bg-amber-600 py-2 rounded text-sm text-white font-medium">Deposit</button>
<button onclick="openWithdrawModal()" class="bg-emerald-500 hover:bg-emerald-600 py-2 rounded text-sm text-white font-medium">Withdraw (20% fee)</button>
</div>
</div>
<!-- ‚úÖ UNIFIED INVESTMENT CARD -->
<div class="mining-card">
<h3 class="text-lg font-bold text-gray-900 mb-3 text-center">Custom Investment</h3>
<p class="text-xs text-gray-600 mb-4 text-center">Minimum: 2√ó your balance. Higher duration = higher returns.</p>
<!-- Amount Input (with validation) -->
<div class="mb-4">
<label class="text-xs text-gray-600 block mb-1">Investment Amount (UGX)</label>
<input
type="number"
id="customInvestAmount"
placeholder="Enter amount"
class="w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 text-sm"
min="1000"
>
<p id="investAmountUSDT" class="text-xs text-gray-500 mt-1">~0.00 USDT</p>
<p id="minAmountNotice" class="text-xs text-red-500 mt-1 hidden">Minimum: <span id="minAmountValue">0</span> UGX</p>
</div>
<!-- Duration Slider -->
<div class="mb-4">
<label class="text-xs text-gray-600 block mb-1">
Duration: <span id="durationValue">10</span> days
</label>
<input
type="range"
id="durationSlider"
min="10"
max="100"
value="10"
step="1"
class="w-full"
>
<div class="flex justify-between text-xs text-gray-500 mt-1">
<span>10 days</span>
<span>100 days</span>
</div>
</div>
<!-- Live Preview -->
<div class="p-3 bg-gray-50 rounded-lg mb-4">
<div class="flex justify-between text-sm mb-1">
<span>Multiplier:</span>
<span id="multiplierValue" class="font-bold text-purple-600">2.0√ó</span>
</div>
<div class="flex justify-between text-sm mb-1">
<span>Total Return:</span>
<span id="totalReturnValue" class="font-bold text-emerald-600">0 UGX</span>
</div>
<div class="flex justify-between text-sm">
<span>USDT Equivalent:</span>
<span id="returnUSDTValue" class="text-xs text-gray-600">~0.00 USDT</span>
</div>
</div>
<!-- Invest Button -->
<button
id="investCustomBtn"
onclick="openInvestModal()"
class="w-full bg-gradient-to-r from-purple-600 to-indigo-700 hover:from-purple-700 hover:to-indigo-800 py-2.5 rounded text-white font-bold shadow"
disabled
>
LOCK INVESTMENT
</button>
</div>
<!-- Active Investments -->
<div class="mining-card mt-4">
<h4 class="font-bold text-gray-900 mb-2">Active Investments</h4>
<div id="activeInvestmentsList" class="text-xs space-y-1 max-h-32 overflow-y-auto">
<p class="text-gray-500">No active investments.</p>
</div>
</div>
<!-- FOMO: Investments -->
<div class="mining-card mt-4">
<h3 class="font-bold text-gray-900 mb-2 text-center">üìà New Investments</h3>
<div id="fomoInvestFeed" class="text-xs space-y-1 max-h-24 overflow-hidden"></div>
</div>
</section>
<!-- PLAY -->
<section id="tab-casino" class="tab-content">
<!-- ‚úÖ TOTAL BALANCE CARD -->
<div class="mining-card w-full max-w-3xl text-center mb-5">
<p class="font-bold text-amber-600 mb-2">Total Balance</p>
<p id="casinoTotalBalance" class="text-3xl font-bold text-amber-700">0 UGX</p>
<p id="casinoTotalBalanceUSDT" class="text-sm text-gray-600">~0.00 USDT</p>
<div class="grid grid-cols-2 gap-3 mt-4">
<button onclick="showDepositInput()" class="bg-amber-500 hover:bg-amber-600 py-2 rounded text-sm text-white font-medium">Deposit</button>
<button onclick="openWithdrawModal()" class="bg-emerald-500 hover:bg-emerald-600 py-2 rounded text-sm text-white font-medium">Withdraw (20% fee)</button>
</div>
</div>
<!-- üé∞ WHEEL GAME -->
<div class="mining-card p-3 bg-gray-50 relative">
<canvas id="rain-canvas" style="position: absolute; top: 0; left: 0; pointer-events: none; z-index: 100; width: 100%; height: 100%;"></canvas>
<div style="position: relative; z-index: 101; width: 100%;">
<div class="wheel-game-container">
<div class="wheel-wrapper">
<div class="pointer"></div>
<canvas id="wheel" width="304" height="304"></canvas>
</div>
<!-- ‚úÖ CENTERED STAKE PANEL -->
<div class="mining-card bg-white stake-panel-centered p-3">
<h4 class="font-bold text-gray-800 text-center mb-2">Place Your Stake</h4>
<div class="flex items-center justify-between mb-2">
<span class="text-xs text-gray-600">Available:</span>
<span id="availableBalanceStake" class="text-sm font-bold text-amber-700">0 UGX</span>
</div>
<div class="relative mb-2">
<input
type="number"
id="stakeInput"
placeholder="Min: 2,000 UGX"
class="w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-emerald-500"
min="2000"
>
<span class="absolute right-2 top-2 text-xs text-gray-500">UGX</span>
</div>
<div id="stakeUSDT" class="text-xs text-gray-600 text-center mb-3">~0.00 USDT</div>
<button id="spinBtn" class="w-full bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 py-2 rounded font-bold text-white shadow">
SPIN WHEEL
</button>
</div>
</div>
</div>
</div>
<!-- üìú GAME HISTORY -->
<div class="mining-card mt-4">
<h4 class="font-bold text-gray-900 mb-2">Game History</h4>
<div id="wheelGameHistory" class="text-xs space-y-1 max-h-32 overflow-y-auto">
<p class="text-gray-500">No games played yet.</p>
</div>
</div>
<!-- FOMO: Wins & Withdrawals -->
<div class="mining-card mt-4">
<h3 class="font-bold text-gray-900 mb-2 text-center">üéâ Big Wins & Cashouts</h3>
<div id="fomoCasinoFeed" class="text-xs space-y-1 max-h-24 overflow-hidden"></div>
</div>
</section>
<!-- PROFILE -->
<section id="tab-profile" class="tab-content">
<div class="mining-card text-center">
<div class="relative inline-block mb-3">
<img id="profileAvatar" src="https://via.placeholder.com/80/10b981/FFFFFF?text=U" alt="Avatar" class="w-20 h-20 rounded-full border-2 border-emerald-500 object-cover" />
<label for="avatarInput" class="absolute bottom-0 right-0 bg-emerald-500 rounded-full p-1 cursor-pointer shadow-md">
<i class="fas fa-camera text-white text-xs"></i>
</label>
<input type="file" id="avatarInput" accept="image/*" class="hidden" />
</div>
<h2 id="profileUserName2" class="text-lg font-bold">---</h2>
<p id="profileUserEmail2" class="text-gray-600 text-sm">---</p>
<p id="profileUserId2" class="text-gray-500 text-xs">ID: ---</p>
<button id="editProfileInfoBtn" class="mt-3 border border-emerald-500 text-emerald-500 px-3 py-1 rounded text-xs font-medium">Edit Profile</button>
</div>
<div class="mining-card mt-4">
<h3 class="font-bold text-gray-900 mb-2">Transaction History</h3>
<div id="transactionHistoryList" class="text-xs space-y-1 max-h-32 overflow-y-auto">
<p class="text-gray-500">No transactions yet.</p>
</div>
</div>
<div class="mining-card mt-4">
<h3 class="font-bold text-gray-900 mb-2">Settings</h3>
<div class="text-xs space-y-3">
<div>
<label class="block text-xs text-gray-600 mb-2">App Theme</label>
<div class="flex items-center justify-center">
<label class="theme-toggle">
<input type="checkbox" id="themeToggle">
<span class="toggle-thumb"></span>
</label>
<span id="themeLabel" class="ml-2 text-xs text-gray-500">Light</span>
</div>
</div>
<div class="flex justify-between items-center">
<span>Auto-claim</span>
<span class="text-emerald-600">On</span>
</div>
</div>
</div>
<div class="mining-card mt-4">
<h3 class="font-bold text-gray-900 mb-2">Support</h3>
<a href="mailto:auraaimoney@gmail.com?subject=UGX%20Mine%20Support" target="_blank" class="block w-full text-center bg-gray-100 hover:bg-gray-200 text-gray-800 py-1.5 rounded text-xs transition">
<i class="fas fa-envelope mr-1"></i>Contact Admin
</a>
</div>
<div class="mt-4 text-center">
<button id="logoutBtn" class="px-4 py-1.5 bg-red-500 hover:bg-red-600 rounded text-white text-xs font-medium">
<i class="fas fa-sign-out-alt mr-1"></i>Logout
</button>
</div>
</section>
</main>
</div>
<!-- ‚úÖ BOTTOM NAV -->
<nav id="bottomNav" class="md:hidden fixed bottom-0 left-0 right-0 z-40">
<div class="flex justify-around items-center py-2">
<button onclick="switchTab('home')" class="flex flex-col items-center active">
<div class="w-6 h-6 flex items-center justify-center"><i class="fas fa-home text-xs"></i></div>
<span class="mt-1">Home</span>
</button>
<button onclick="switchTab('investments')" class="flex flex-col items-center">
<div class="w-6 h-6 flex items-center justify-center"><i class="fas fa-chart-line text-xs"></i></div>
<span class="mt-1">Invest</span>
</button>
<button onclick="switchTab('casino')" class="flex flex-col items-center">
<div class="w-6 h-6 flex items-center justify-center"><i class="fas fa-dice text-xs"></i></div>
<span class="mt-1">Play</span>
</button>
<button onclick="switchTab('profile')" class="flex flex-col items-center">
<div class="w-6 h-6 flex items-center justify-center"><i class="fas fa-user text-xs"></i></div>
<span class="mt-1">Me</span>
</button>
</div>
</nav>
</div>
<!-- MODALS -->
<div id="editProfileModal" class="fixed inset-0 bg-black/70 flex items-center justify-center hidden z-50">
<div class="bg-white p-6 rounded-xl w-96 shadow-xl">
<h3 class="text-lg font-bold mb-4 text-gray-900">Edit Profile</h3>
<div class="mb-3">
<label class="block text-xs text-gray-600 mb-1">Username</label>
<input type="text" id="editUsername" class="w-full bg-gray-50 p-2 rounded text-sm border" readonly>
</div>
<div class="mb-3">
<label class="block text-xs text-gray-600 mb-1">Email</label>
<input type="email" id="editEmail" class="w-full bg-gray-50 p-2 rounded text-sm border">
</div>
<div class="mb-4">
<label class="block text-xs text-gray-600 mb-1">Arbitrum Wallet</label>
<input type="text" id="editWallet" class="w-full bg-gray-50 p-2 rounded text-sm border" placeholder="0x...">
</div>
<div class="flex gap-2">
<button id="saveProfileBtn" class="flex-1 bg-emerald-600 py-2 rounded text-white text-sm font-medium">Save</button>
<button onclick="document.getElementById('editProfileModal').classList.add('hidden')" class="flex-1 bg-gray-200 py-2 rounded text-sm">Cancel</button>
</div>
</div>
</div>
<!-- ‚úÖ UNIFIED PAYMENT MODAL -->
<div id="paymentModal" class="fixed inset-0 bg-black/80 flex items-center justify-center hidden z-50">
<div class="bg-white p-6 rounded-xl w-96">
<h3 class="text-lg font-bold mb-3" id="paymentModalTitle">Confirm Action</h3>
<div class="bg-gray-50 p-3 rounded mb-3 text-sm">
<div class="flex justify-between"><span>Action:</span> <span id="paymentAction">‚Äî</span></div>
<div class="flex justify-between"><span>Amount:</span> <span id="paymentAmount">‚Äî</span></div>
<div class="flex justify-between"><span>USDT:</span> <span id="paymentUSDT" class="font-bold text-emerald-600">‚Äî</span></div>
</div>
<p class="text-sm mb-2">Send <strong id="usdtToSend">‚Äî</strong> USDT to the admin wallet below using <strong>Arbitrum Network</strong>:</p>
<div class="flex items-center bg-gray-100 p-2 rounded mb-3">
<code id="adminWalletDisplay" class="text-xs break-all flex-1">0xb9fec9b1a49726089f058de4f4225ecbaa88cbbc</code>
<button onclick="copyAdminWallet()" class="text-emerald-500 ml-2 text-sm">Copy</button>
</div>
<p class="text-xs text-red-500 mb-3">‚ö†Ô∏è <strong>Arbitrum ONLY!</strong> Sending from BSC, Ethereum, or TRON will lose your funds.</p>
<p class="text-sm mb-2">Enter Transaction ID:</p>
<input type="text" id="paymentTxId" class="w-full bg-gray-100 p-2 rounded mb-4" placeholder="e.g. 0xabc123...">
<div class="flex gap-2">
<button id="submitPaymentBtn" onclick="submitPayment()" class="flex-1 bg-emerald-600 py-2 rounded text-white">Submit for Approval</button>
<button onclick="document.getElementById('paymentModal').classList.add('hidden')" class="flex-1 bg-gray-300 py-2 rounded">Cancel</button>
</div>
</div>
</div>
<!-- BOOSTER MODAL -->
<div id="boosterModal" class="fixed inset-0 bg-black/80 flex items-center justify-center hidden z-50">
<div class="bg-white p-6 rounded-xl w-96">
<h3 class="text-lg font-bold mb-3" id="boosterModalTitle">Activate Booster</h3>
<p id="boosterModalCurrent" class="text-gray-600 text-sm mb-1">Currently: ...</p>
<p id="boosterModalNew" class="text-emerald-600 font-bold mb-2">After: ...</p>
<p class="text-sm mb-1">Price: <span id="boosterModalPriceUGX">0 UGX</span></p>
<p class="text-sm mb-3">Send <strong id="boosterModalPriceUSDT">0.00</strong> USDT to the admin wallet below using <strong>Arbitrum Network</strong>:</p>
<div class="flex items-center bg-gray-100 p-2 rounded mb-3">
<code id="adminWalletBooster" class="text-xs break-all flex-1">0xb9fec9b1a49726089f058de4f4225ecbaa88cbbc</code>
<button onclick="copyAdminWallet()" class="text-emerald-500 ml-2 text-sm">Copy</button>
</div>
<p class="text-xs text-red-500 mb-3">‚ö†Ô∏è <strong>Arbitrum ONLY!</strong> Sending from BSC, Ethereum, or TRON will lose your funds.</p>
<p class="text-sm mb-2">Enter Transaction ID:</p>
<input type="text" id="txIdInput" class="w-full bg-gray-100 p-2 rounded mb-4" placeholder="e.g. 0xabc123...">
<div class="flex gap-2">
<button id="submitBoosterBtn" onclick="submitBoosterRequest()" class="flex-1 bg-emerald-600 py-2 rounded text-white">Submit for Approval</button>
<button onclick="document.getElementById('boosterModal').classList.add('hidden')" class="flex-1 bg-gray-300 py-2 rounded">Cancel</button>
</div>
</div>
</div>
<!-- ‚úÖ RECEIPT MODAL -->
<div id="receiptModal" class="fixed inset-0 bg-black/80 flex items-center justify-center hidden z-50">
<div class="bg-white p-6 rounded-xl w-96 max-w-[95vw] shadow-xl">
<div class="flex justify-between items-start mb-4">
<h3 class="text-lg font-bold text-gray-900">Transaction Receipt</h3>
<button onclick="document.getElementById('receiptModal').classList.add('hidden')" class="text-gray-500 hover:text-gray-700">
<i class="fas fa-times"></i>
</button>
</div>
<div id="receiptContent" class="text-sm space-y-2 mb-4">
<!-- Filled by JS -->
</div>
<div class="flex gap-2">
<button onclick="printReceipt()" class="flex-1 bg-emerald-600 py-2 rounded text-white text-sm font-medium">Print</button>
<button onclick="document.getElementById('receiptModal').classList.add('hidden')" class="flex-1 bg-gray-300 py-2 rounded text-sm">Close</button>
</div>
</div>
</div>
<!-- SCRIPTS -->
<script>
// üî• SUPABASE
const SUPABASE_URL = 'https://rryvibgbpqyumfmgsiua.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJyeXZpYmdicHF5dW1mbWdzaXVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4OTUwNTUsImV4cCI6MjA4MjQ3MTA1NX0.IMqZtMEiPyMwb8AW1gyFao9Yz2qWgMDibfbpVWOeG8o';
const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
let user = null;
let timer;
const UGX_PER_USDT = 3700;
// ==== FOMO DATA GENERATOR ====
const ugNames = ["Mugisha", "Nalweyiso", "Kato", "Namutebi", "Ssebunya", "Kyomuhendo", "Nabwire", "Okello", "Tumwine", "Ahebwe"];
const boosterTypes = ["Eager_Miner", "Falcon_Miner", "Phoenix_Miner"];
const investDurations = [10, 20, 30, 50, 75, 100];
let fomoIntervals = [];
function generateFakeName() {
return ugNames[Math.floor(Math.random() * ugNames.length)] + Math.floor(Math.random() * 900 + 100);
}
function startFomoFeed(containerId, type) {
const container = document.getElementById(containerId);
if (!container) return;
const existing = fomoIntervals.find(f => f.id === containerId);
if (existing) clearInterval(existing.interval);
const feed = () => {
const item = document.createElement('div');
item.className = 'text-xs py-1 border-b border-gray-100 dark:border-gray-700 flex justify-between';
let html = '';
switch (type) {
case 'booster':
const bType = boosterTypes[Math.floor(Math.random() * boosterTypes.length)];
const bPrice = (Math.random() * 50000 + 20000).toFixed(0);
html = `<span><strong>${generateFakeName()}</strong> bought <em>${bType}</em></span> <span class="text-emerald-600">${bPrice} UGX</span>`;
break;
case 'withdraw':
const wAmt = (Math.random() * 200000 + 50000).toFixed(0);
html = `<span><strong>${generateFakeName()}</strong> withdrew</span> <span class="text-red-600">-${wAmt} UGX</span>`;
break;
case 'deposit':
const dAmt = (Math.random() * 300000 + 10000).toFixed(0);
html = `<span><strong>${generateFakeName()}</strong> deposited</span> <span class="text-emerald-600">+${dAmt} UGX</span>`;
break;
case 'invest':
const days = investDurations[Math.floor(Math.random() * investDurations.length)];
const iAmt = (Math.random() * 500000 + 100000).toFixed(0);
html = `<span><strong>${generateFakeName()}</strong> invested</span> <span class="text-purple-600">${iAmt} UGX for ${days}d</span>`;
break;
case 'win':
const winAmt = (Math.random() * 100000 + 5000).toFixed(0);
const multipliers = ["2x", "5x", "10x", "MEGA"];
const mult = multipliers[Math.floor(Math.random() * multipliers.length)];
html = `<span><strong>${generateFakeName()}</strong> won with <em>${mult}</em></span> <span class="text-green-600">+${winAmt} UGX</span>`;
break;
}
item.innerHTML = html;
container.prepend(item);
if (container.children.length > 5) container.removeChild(container.lastChild);
};
const interval = setInterval(feed, 8000 + Math.random() * 4000);
fomoIntervals.push({ id: containerId, interval });
}
// ========================
// LIVE USDT UPDATE FOR DEPOSIT INPUT
// ========================
document.getElementById('depositAmountInput').addEventListener('input', () => {
const amount = parseFloat(document.getElementById('depositAmountInput').value) || 0;
const usdt = (amount / UGX_PER_USDT).toFixed(4);
document.getElementById('depositAmountUSDT').textContent = `~${usdt} USDT`;
});
// ========================
// SHOW DEPOSIT INPUT MODAL
// ========================
function showDepositInput() {
document.getElementById('depositInputModal').classList.remove('hidden');
document.getElementById('depositAmountInput').value = '';
document.getElementById('depositAmountUSDT').textContent = '~0.00 USDT';
}
// ========================
// CONFIRM DEPOSIT AMOUNT & OPEN PAYMENT MODAL
// ========================
function confirmDepositAmount() {
const input = document.getElementById('depositAmountInput');
const amount = parseFloat(input.value);
if (!amount || amount < 10000) {
alert('Minimum deposit is 10,000 UGX');
return;
}
document.getElementById('depositInputModal').classList.add('hidden');
openPaymentModal('deposit', amount, 'Deposit Funds');
}
// ========================
// INVESTMENT LOGIC (10X at 100 days)
// ========================
function getMultiplier(days) {
const clampedDays = Math.min(100, Math.max(10, days));
const multiplier = 2 + (clampedDays - 10) * (8 / 90);
return parseFloat(multiplier.toFixed(2));
}
function updateInvestPreview() {
const amountInput = document.getElementById('customInvestAmount');
const amount = parseFloat(amountInput.value) || 0;
const days = parseInt(document.getElementById('durationSlider').value);
document.getElementById('durationValue').textContent = days;
const multiplier = getMultiplier(days);
const totalReturn = amount * multiplier;
const amountUSDT = (amount / UGX_PER_USDT).toFixed(4);
const returnUSDT = (totalReturn / UGX_PER_USDT).toFixed(4);
document.getElementById('investAmountUSDT').textContent = `~${amountUSDT} USDT`;
document.getElementById('multiplierValue').textContent = `${multiplier}√ó`;
document.getElementById('totalReturnValue').textContent = `${totalReturn.toLocaleString()} UGX`;
document.getElementById('returnUSDTValue').textContent = `~${returnUSDT} USDT`;
const minAmount = (user?.balance || 0) * 2;
const minNotice = document.getElementById('minAmountNotice');
const minValue = document.getElementById('minAmountValue');
const btn = document.getElementById('investCustomBtn');
if (amount > 0 && amount < minAmount) {
amountInput.classList.add('border-red-500');
amountInput.classList.remove('border-gray-300');
minValue.textContent = minAmount.toLocaleString();
minNotice.classList.remove('hidden');
btn.disabled = true;
} else {
amountInput.classList.remove('border-red-500');
amountInput.classList.add('border-gray-300');
minNotice.classList.add('hidden');
btn.disabled = (amount <= 0);
}
}
document.getElementById('customInvestAmount').addEventListener('input', updateInvestPreview);
document.getElementById('durationSlider').addEventListener('input', updateInvestPreview);
// ========================
// UNIFIED PAYMENT SYSTEM
// ========================
const ADMIN_WALLET = "0xb9fec9b1a49726089f058de4f4225ecbaa88cbbc";
function copyAdminWallet() {
navigator.clipboard.writeText(ADMIN_WALLET);
alert('Admin Arbitrum wallet copied!');
}
let currentPaymentType = null;
let currentPaymentAmountUGX = 0;
let currentPaymentUSDT = 0;
function openPaymentModal(type, amountUGX, description) {
currentPaymentType = type;
currentPaymentAmountUGX = amountUGX;
currentPaymentUSDT = (amountUGX / UGX_PER_USDT).toFixed(4);
document.getElementById('paymentModalTitle').textContent =
type === 'withdraw' ? 'Confirm Withdrawal' :
type === 'invest' ? 'Confirm Investment' : 'Confirm Deposit';
document.getElementById('paymentAction').textContent =
type === 'withdraw' ? 'Withdraw Fee' :
type === 'invest' ? 'Investment Lock' : 'Deposit Funds';
document.getElementById('paymentAmount').textContent = `${amountUGX.toLocaleString()} UGX`;
document.getElementById('paymentUSDT').textContent = `${currentPaymentUSDT} USDT`;
document.getElementById('usdtToSend').textContent = currentPaymentUSDT;
document.getElementById('adminWalletDisplay').textContent = ADMIN_WALLET;
document.getElementById('paymentTxId').value = '';
document.getElementById('paymentModal').classList.remove('hidden');
}
async function submitPayment() {
const txId = document.getElementById('paymentTxId').value.trim();
if (!txId) return alert('Please enter Transaction ID.');
const actionMap = {
deposit: 'deposit_requests',
invest: 'investment_requests',
withdraw: 'withdraw_requests'
};
const table = actionMap[currentPaymentType];
if (!table) return;
const receiptId = 'RCP-' + Date.now() + '-' + Math.random().toString(36).substr(2, 5);
const data = {
username: user.username,
txid: txId,
status: 'pending',
requested_at: new Date().toISOString(),
receipt_id: receiptId
};
if (currentPaymentType === 'deposit') {
data.ugx_amount = currentPaymentAmountUGX;
data.usdt_amount = parseFloat(currentPaymentUSDT);
}
else if (currentPaymentType === 'invest') {
const days = parseInt(document.getElementById('durationSlider').value);
const multiplier = getMultiplier(days);
data.ugx_amount = currentPaymentAmountUGX;
data.ugx_return = currentPaymentAmountUGX * multiplier;
data.usdt_paid = parseFloat(currentPaymentUSDT);
data.days = days;
data.multiplier = multiplier;
data.maturity_time = new Date(Date.now() + days * 24 * 3600000).toISOString();
}
else if (currentPaymentType === 'withdraw') {
data.ugx_amount = user.balance || 0;
data.ugx_fee = currentPaymentAmountUGX;
data.usdt_fee = parseFloat(currentPaymentUSDT);
}
await _supabase.from(table).insert(data);
document.getElementById('paymentModal').classList.add('hidden');
if (currentPaymentType === 'withdraw') {
alert('Withdrawal request submitted!\nSend the 20% fee and wait for admin approval.');
} else {
alert(`Request submitted! Wait for admin approval.`);
}
}
// ========================
// ORIGINAL openDepositModal REMOVED ‚Äì REPLACED BY showDepositInput()
// ========================
function openInvestModal() {
const amount = parseFloat(document.getElementById('customInvestAmount').value);
const minAmount = (user?.balance || 0) * 2;
if (!amount || amount <= 0) return alert("Enter a valid amount");
if (amount < minAmount) return alert(`Minimum: ${minAmount.toLocaleString()} UGX`);
openPaymentModal('invest', amount, 'Lock Investment');
}
function openWithdrawModal() {
if (!user || (user.balance || 0) <= 0) return alert("No balance to withdraw");
const balance = user.balance || 0;
const fee = balance * 0.2;
openPaymentModal('withdraw', fee, 'Withdraw Fee');
}
// ========================
// BOOSTER SYSTEM (UNCHANGED)
// ========================
function updateBoosterPrices() {
if (!user) return;
const balance = user.balance || 0;
const boosters = [
{ id: 'Eagle', mult: 2 },
{ id: 'Falcon', mult: 4 },
{ id: 'Phoenix', mult: 8 }
];
boosters.forEach(b => {
const priceUGX = balance * b.mult;
const priceUSDT = (priceUGX / UGX_PER_USDT).toFixed(4);
document.getElementById(`price${b.id}`).textContent =
`${priceUGX.toLocaleString()} UGX (~${priceUSDT} USDT)`;
});
}
let selectedBoosterType, selectedBoosterHours, selectedBoosterReward;
function openBoosterModal(type, hours, reward) {
if (!user) return;
selectedBoosterType = type;
selectedBoosterHours = hours;
selectedBoosterReward = reward;
const balance = user.balance || 0;
const multiplier = type === 'eagle' ? 2 : type === 'falcon' ? 4 : 8;
const priceUGX = balance * multiplier;
const priceUSDT = (priceUGX / UGX_PER_USDT).toFixed(4);
const currentReward = user.mining_reward || 5000;
const currentHours = user.mining_cycle_hours || 24;
const newReward = currentReward + reward;
document.getElementById('boosterModalTitle').textContent = `Activate ${type.charAt(0).toUpperCase() + type.slice(1)}_Miner`;
document.getElementById('boosterModalCurrent').innerHTML = `Currently: <strong>${currentReward.toLocaleString()} UGX / ${currentHours}h</strong>`;
document.getElementById('boosterModalNew').innerHTML = `After: <strong>${newReward.toLocaleString()} UGX / 2h</strong>`;
document.getElementById('boosterModalPriceUGX').textContent = `${priceUGX.toLocaleString()} UGX`;
document.getElementById('boosterModalPriceUSDT').textContent = priceUSDT;
document.getElementById('adminWalletBooster').textContent = ADMIN_WALLET;
document.getElementById('txIdInput').value = '';
document.getElementById('boosterModal').classList.remove('hidden');
}
async function submitBoosterRequest() {
const txId = document.getElementById('txIdInput').value.trim();
if (!txId) return alert('Please enter TRX ID');
const balance = user.balance || 0;
const multiplier = selectedBoosterType === 'eagle' ? 2 : selectedBoosterType === 'falcon' ? 4 : 8;
const priceUGX = balance * multiplier;
const priceUSDT = (priceUGX / UGX_PER_USDT).toFixed(4);
const boosterName =
selectedBoosterType === 'eagle' ? 'Eager_Miner' :
selectedBoosterType === 'falcon' ? 'Falcon_Miner' : 'Phoenix_Miner';
const receiptId = 'RCP-' + Date.now() + '-' + Math.random().toString(36).substr(2, 5);
await _supabase.from('booster_requests').insert({
username: user.username,
booster_type: boosterName,
usdt_amount: parseFloat(priceUSDT),
txid: txId,
status: 'pending',
requested_at: new Date().toISOString(),
receipt_id: receiptId
});
document.getElementById('boosterModal').classList.add('hidden');
alert('Booster request submitted! Wait for admin approval.');
}
// ========================
// CLAIM BUTTON LOGIC
// ========================
function startTimer() {
if (timer) clearInterval(timer);
const nextClaimTime = new Date(user.next_claim_time).getTime();
const miningBtn = document.getElementById('miningBtn');
const updateClaimButton = () => {
const now = Date.now();
const diff = nextClaimTime - now;
if (diff <= 0) {
miningBtn.textContent = "Claim Funds";
miningBtn.classList.remove('opacity-75', 'cursor-not-allowed');
miningBtn.disabled = false;
} else {
const h = Math.floor(diff / 3600000).toString().padStart(2, '0');
const m = Math.floor((diff % 3600000) / 60000).toString().padStart(2, '0');
const s = Math.floor((diff % 60000) / 1000).toString().padStart(2, '0');
miningBtn.textContent = `${h}:${m}:${s}`;
miningBtn.classList.add('opacity-75', 'cursor-not-allowed');
miningBtn.disabled = true;
}
};
updateClaimButton();
timer = setInterval(updateClaimButton, 1000);
}
document.getElementById('miningBtn').onclick = async () => {
const btn = document.getElementById('miningBtn');
if (btn.textContent !== "Claim Funds") return;
if (user.booster_expires_at) {
const now = new Date();
const expiry = new Date(user.booster_expires_at);
if (now > expiry) {
await _supabase.from('users').update({
mining_cycle_hours: 24,
mining_reward: 5000,
booster_expires_at: null,
booster_type: null
}).eq('username', user.username);
user.mining_cycle_hours = 24;
user.mining_reward = 5000;
user.booster_expires_at = null;
user.booster_type = null;
}
}
const reward = user.mining_reward || 5000;
const newBalance = (user.balance || 0) + reward;
const next = new Date(Date.now() + ((user.mining_cycle_hours || 24) * 3600000)).toISOString();
await _supabase.from('users').update({
balance: newBalance,
claimed_total: (user.claimed_total || 0) + reward,
next_claim_time: next
}).eq('username', user.username);
user.balance = newBalance;
user.claimed_total = (user.claimed_total || 0) + reward;
user.next_claim_time = next;
updateHomeDashboard();
startTimer();
};
// ========================
// üí∞ UNIFIED BALANCE SYSTEM
// ========================
async function updateHomeDashboard() {
if (!user) return;
const balance = user.balance || 0;
const formatted = balance.toLocaleString() + " UGX";
const usdt = "~" + (balance / UGX_PER_USDT).toFixed(2) + " USDT";
// Update all balance displays
document.getElementById('totalBalance').textContent = formatted;
document.getElementById('totalBalanceUSDT').textContent = usdt;
document.getElementById('investTotalBalance').textContent = formatted;
document.getElementById('investTotalBalanceUSDT').textContent = usdt;
document.getElementById('casinoTotalBalance').textContent = formatted;
document.getElementById('casinoTotalBalanceUSDT').textContent = usdt;
// Update stake panel
document.getElementById('availableBalanceStake').textContent = formatted;
// Update claim & status
const nextReward = user.mining_reward || 5000;
document.getElementById('nextClaimAmount').innerHTML = `<i class="fas fa-coins text-emerald-500 mr-1"></i>${nextReward.toLocaleString()} UGX`;
let statusText = "Default 24h cycle";
if (user.booster_expires_at) {
const expiry = new Date(user.booster_expires_at);
if (expiry > new Date()) {
statusText = `<i class="fas fa-bolt text-amber-500 mr-1"></i>${user.booster_type}`;
}
}
document.getElementById('miningStatus').innerHTML = statusText;
updateBoosterPrices();
updateInvestPreview();
}
// ========================
// üé° WHEEL GAME LOGIC
// ========================
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
let isSpinning = false;
const sectors = ["0x", "5x", "MEGA", "2x", "0x", "10x", "ROYAL", "2x", "0x", "5x", "GRAND", "2x", "0x", "10x", "1.5x", "2x"];
const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');
const rainCanvas = document.getElementById('rain-canvas');
const rainCtx = rainCanvas.getContext('2d');
let particles = [];
function playTone(freq, type, dur, vol = 0.1) {
const osc = audioCtx.createOscillator();
const gain = audioCtx.createGain();
osc.type = type;
osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
gain.gain.setValueAtTime(vol, audioCtx.currentTime);
gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + dur);
osc.connect(gain); gain.connect(audioCtx.destination);
osc.start(); osc.stop(audioCtx.currentTime + dur);
}
const sounds = {
tick: () => playTone(600, 'sine', 0.1, 0.05),
loss: () => { playTone(150, 'sawtooth', 0.5); playTone(110, 'sawtooth', 0.5); },
smallWin: () => { playTone(523, 'sine', 0.2); setTimeout(() => playTone(659, 'sine', 0.2), 100); },
bigWin: () => { [523, 659, 783, 1046].forEach((f, i) => setTimeout(() => playTone(f, 'square', 0.4, 0.05), i * 100)); },
jackpot: () => { [523, 659, 783, 1046, 1318, 1567].forEach((f, i) => setTimeout(() => playTone(f, 'sine', 1, 0.1), i * 100)); }
};
function createRain() {
for(let i = 0; i < 100; i++) {
particles.push({
x: Math.random() * window.innerWidth,
y: Math.random() * -window.innerHeight,
size: Math.random() * 10 + 5,
speed: Math.random() * 5 + 2,
color: `hsl(${Math.random() * 360}, 70%, 60%)`
});
}
animateRain();
}
function animateRain() {
rainCtx.clearRect(0, 0, rainCanvas.width, rainCanvas.height);
particles.forEach((p, i) => {
p.y += p.speed;
rainCtx.fillStyle = p.color;
rainCtx.font = p.size + "px Arial";
rainCtx.fillText("$", p.x, p.y);
if(p.y > window.innerHeight) particles.splice(i, 1);
});
if(particles.length > 0) requestAnimationFrame(animateRain);
}
// ‚úÖ UPDATED drawWheel WITH UNIQUE COLORS
function drawWheel() {
const totalSectors = sectors.length;
const arc = (2 * Math.PI) / totalSectors;
// Define 15 distinct hues (avoiding red ~0¬∞)
const hues = [30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330, 20, 50, 80, 110];
let hueIndex = 0;
sectors.forEach((label, i) => {
const angle = i * arc;
ctx.save();
ctx.beginPath();
if (label === "0x") {
ctx.fillStyle = "#e74c3c"; // Keep red for losses
} else {
const hue = hues[hueIndex % hues.length];
ctx.fillStyle = `hsl(${hue}, 70%, 60%)`;
hueIndex++;
}
ctx.moveTo(152, 152);
ctx.arc(152, 152, 152, angle, angle + arc);
ctx.fill();
ctx.translate(152, 152);
ctx.rotate(angle + arc / 2);
ctx.textAlign = "right";
ctx.fillStyle = "white";
ctx.font = "bold 14px Arial";
ctx.fillText(label, 137, 5);
ctx.restore();
});
}
// Stake input live USDT update
document.getElementById('stakeInput').addEventListener('input', () => {
const stake = parseFloat(document.getElementById('stakeInput').value) || 0;
const usdt = (stake / UGX_PER_USDT).toFixed(4);
document.getElementById('stakeUSDT').textContent = `~${usdt} USDT`;
});
// SPIN
async function spin() {
if (isSpinning || !user) return;
const stakeInput = document.getElementById('stakeInput');
const stake = parseFloat(stakeInput.value);
if (isNaN(stake) || stake < 2000) return alert("Minimum stake is 2,000 UGX");
if (stake > user.balance) return alert("Insufficient balance");
user.balance -= stake;
await _supabase.from('users').update({ balance: user.balance }).eq('username', user.username);
updateHomeDashboard();
isSpinning = true;
const btn = document.getElementById('spinBtn');
btn.textContent = "SPINNING...";
btn.disabled = true;
const spinDeg = Math.floor(Math.random() * 360) + 3600;
let currentRotation = parseFloat(canvas.style.transform.replace('rotate(', '').replace('deg)', '') || 0);
currentRotation += spinDeg;
canvas.style.transform = `rotate(${currentRotation}deg)`;
let ticks = 0;
const tickInt = setInterval(() => { ticks++; if(ticks < 40) sounds.tick(); else clearInterval(tickInt); }, 100);
setTimeout(async () => {
const sectorIndex = Math.floor((360 - (currentRotation % 360) + 270) % 360 / (360 / sectors.length));
const res = sectors[sectorIndex];
let mult = 0;
let win = 0;
let soundType = 'loss';
if (res === "MEGA") {
mult = 100;
soundType = 'jackpot';
createRain();
} else if (res === "ROYAL") {
mult = 75;
soundType = 'jackpot';
createRain();
} else if (res === "GRAND") {
mult = 50;
soundType = 'jackpot';
createRain();
} else {
mult = parseFloat(res);
if (mult === 0) {
soundType = 'loss';
} else if (mult > 2) {
soundType = 'bigWin';
} else {
soundType = 'smallWin';
}
}
win = stake * mult;
// Update balance & history
if (win > 0) {
user.balance += win;
await _supabase.from('users').update({ balance: user.balance }).eq('username', user.username);
addWheelHistory(res, win);
} else {
addWheelHistory(res, -stake);
}
// Sync sound + popup
sounds[soundType]();
// Create or update popup
const wheelWrapper = document.querySelector('#tab-casino .wheel-wrapper');
let popup = document.getElementById('wheel-popup');
if (!popup) {
popup = document.createElement('div');
popup.id = 'wheel-popup';
popup.style.cssText = `
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
z-index: 102;
pointer-events: none;
width: 160px;
`;
wheelWrapper.appendChild(popup);
}
// ‚úÖ UPDATED POPUP STYLE: CENTERED, CLASSIC, COLOR-CODED
let message, bgColor, textColor;
if (win > 0) {
message = `WIN<br>${win.toLocaleString()} UGX`;
bgColor = '#dcfce7'; // light green
textColor = '#166534'; // dark green
} else {
message = 'LOST';
bgColor = '#fee2e2'; // light red
textColor = '#991b1b'; // dark red
}
popup.innerHTML = `
<div style="
background: ${bgColor};
color: ${textColor};
border-radius: 8px;
padding: 0.6rem 1rem;
font-size: 1.1rem;
font-weight: bold;
text-align: center;
box-shadow: 0 4px 12px rgba(0,0,0,0.15);
animation: fadeInOut 3s ease-in-out forwards;
">
${message}
</div>
`;
// Final UI cleanup
updateHomeDashboard();
stakeInput.value = "";
document.getElementById('stakeUSDT').textContent = "~0.00 USDT";
isSpinning = false;
btn.textContent = "SPIN WHEEL";
btn.disabled = false;
}, 4000);
}
document.getElementById('spinBtn').onclick = spin;
function addWheelHistory(res, amount) {
const list = document.getElementById('wheelGameHistory');
const item = document.createElement('div');
item.className = 'flex justify-between text-xs';
const isWin = amount > 0;
item.innerHTML = `<span>${res}</span><span style="color:${isWin ? '#00ff88' : '#ff4757'}">${isWin ? '+' : ''}${amount.toFixed(0)}</span>`;
list.insertBefore(item, list.firstChild);
if (list.children.length > 10) list.removeChild(list.lastChild);
}
// Init wheel
setTimeout(() => drawWheel(), 100);
function resizeRainCanvas() {
const container = document.querySelector('#tab-casino .mining-card');
if (container) {
rainCanvas.width = container.clientWidth;
rainCanvas.height = container.clientHeight;
}
}
window.addEventListener('resize', resizeRainCanvas);
resizeRainCanvas();
// ========================
// PROFILE & NAV
// ========================
document.getElementById('editProfileInfoBtn').onclick = () => {
if (!user) return;
document.getElementById('editUsername').value = user.username || '';
document.getElementById('editEmail').value = user.user_email || '';
document.getElementById('editWallet').value = user.user_wallet || '';
document.getElementById('editProfileModal').classList.remove('hidden');
};
document.getElementById('saveProfileBtn').onclick = async () => {
const email = document.getElementById('editEmail').value.trim();
const wallet = document.getElementById('editWallet').value.trim();
if (!email || !wallet) return alert("Email and wallet are required.");
if (!/^0x[a-zA-Z0-9]{40}$/.test(wallet)) return alert("Invalid Arbitrum wallet address.");
await _supabase.from('users').update({ user_email: email, user_wallet: wallet }).eq('username', user.username);
user.user_email = email;
user.user_wallet = wallet;
document.getElementById('profileUserEmail').textContent = email;
document.getElementById('profileUserEmail2').textContent = email;
alert("Profile updated!");
document.getElementById('editProfileModal').classList.add('hidden');
};
document.getElementById('avatarInput').onchange = (e) => {
const file = e.target.files[0];
if (file && file.type.startsWith('image/')) {
const reader = new FileReader();
reader.onload = (event) => {
document.getElementById('profileAvatar').src = event.target.result;
};
reader.readAsDataURL(file);
}
};
document.getElementById('tabSignup').onclick = () => {
document.getElementById('signupForm').classList.remove('hidden');
document.getElementById('loginForm').classList.add('hidden');
document.getElementById('tabSignup').classList.add('active');
document.getElementById('tabLogin').classList.remove('active');
};
document.getElementById('tabLogin').onclick = () => {
document.getElementById('loginForm').classList.remove('hidden');
document.getElementById('signupForm').classList.add('hidden');
document.getElementById('tabLogin').classList.add('active');
document.getElementById('tabSignup').classList.remove('active');
};
document.getElementById('signupForm').onsubmit = async (e) => {
e.preventDefault();
const u = document.getElementById('signupUsername').value;
const em = document.getElementById('signupEmail').value;
const p = document.getElementById('signupPassword').value;
const { error } = await _supabase.from('users').insert([{
username: u, password: p, user_email: em, balance: 0, mining_reward: 5000,
mining_cycle_hours: 24, next_claim_time: new Date().toISOString(),
user_id: 'UGX' + Math.floor(Math.random()*1000000), user_wallet: null,
withdraw_day: null, booster_expires_at: null, booster_type: null, referral_count: 0, claimed_total: 0
}]);
if (error) alert(error.message); else alert("Signup Success! Please Login.");
};
document.getElementById('loginForm').onsubmit = async (e) => {
e.preventDefault();
const u = document.getElementById('loginUsername').value;
const p = document.getElementById('loginPassword').value;
const { data } = await _supabase.from('users').select('*').eq('username', u).eq('password', p).maybeSingle();
if (!data) return alert("Wrong credentials");
user = data;
localStorage.setItem('ugxmine_session', JSON.stringify({ username: u, password: p }));
document.getElementById('authCard').classList.add('hidden');
document.getElementById('mainApp').classList.remove('hidden');
loadDashboard();
};
function logout() {
user = null;
localStorage.removeItem('ugxmine_session');
document.getElementById('mainApp').classList.add('hidden');
document.getElementById('authCard').classList.remove('hidden');
}
document.getElementById('authToggle').onclick = logout;
document.getElementById('logoutBtn').onclick = logout;
function switchTab(tabName) {
// Clear previous FOMO intervals to avoid memory leak
fomoIntervals.forEach(f => clearInterval(f.interval));
fomoIntervals = [];
document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
document.getElementById(`tab-${tabName}`).classList.add('active');
document.querySelectorAll('#bottomNav button').forEach(btn => btn.classList.remove('active'));
const activeBtn = Array.from(document.querySelectorAll('#bottomNav button')).find(btn =>
btn.getAttribute('onclick')?.includes(`switchTab('${tabName}')`)
);
if (activeBtn) activeBtn.classList.add('active');
// Start FOMO feeds per tab
if (tabName === 'home') {
startFomoFeed('fomoBoosterFeed', 'booster');
// Alternate deposit/withdraw every 10 sec in same feed
let txType = 'deposit';
setInterval(() => {
const container = document.getElementById('fomoTxFeed');
if (!container) return;
const name = generateFakeName();
const item = document.createElement('div');
item.className = 'text-xs py-1 border-b border-gray-100 dark:border-gray-700 flex justify-between';
if (txType === 'deposit') {
const amt = (Math.random() * 300000 + 10000).toFixed(0);
item.innerHTML = `<span><strong>${name}</strong> deposited</span> <span class="text-emerald-600">+${amt} UGX</span>`;
} else {
const amt = (Math.random() * 200000 + 50000).toFixed(0);
item.innerHTML = `<span><strong>${name}</strong> withdrew</span> <span class="text-red-600">-${amt} UGX</span>`;
}
container.prepend(item);
if (container.children.length > 5) container.removeChild(container.lastChild);
txType = txType === 'deposit' ? 'withdraw' : 'deposit';
}, 10000);
} else if (tabName === 'investments') {
startFomoFeed('fomoInvestFeed', 'invest');
} else if (tabName === 'casino') {
startFomoFeed('fomoCasinoFeed', 'win');
// Occasionally inject withdrawal
setInterval(() => {
const container = document.getElementById('fomoCasinoFeed');
if (container && Math.random() > 0.7) {
const name = generateFakeName();
const amt = (Math.random() * 150000 + 30000).toFixed(0);
const item = document.createElement('div');
item.className = 'text-xs py-1 border-b border-gray-100 dark:border-gray-700 flex justify-between';
item.innerHTML = `<span><strong>${name}</strong> cashed out</span> <span class="text-red-600">-${amt} UGX</span>`;
container.prepend(item);
if (container.children.length > 5) container.removeChild(container.lastChild);
}
}, 12000);
} else if (tabName === 'profile') {
loadTransactionHistory();
}
}

// ========================
// ‚úÖ FIXED: TRANSACTION HISTORY SYNC (ALL TYPES)
// ========================
async function loadTransactionHistory() {
  if (!user) return;
  const tables = [
    { name: 'deposit', label: 'Deposit' },
    { name: 'withdraw', label: 'Withdraw' },
    { name: 'investment', label: 'Investment' },
    { name: 'booster', label: 'Booster' }
  ];
  let allTxs = [];

  for (const { name, label } of tables) {
    const tableName = `${name}_requests`;
    const { data } = await _supabase
      .from(tableName)
      .select('*')
      .eq('username', user.username)
      .order('requested_at', { ascending: false });

    if (data) {
      data.forEach(tx => {
        tx.displayType = label;
        tx.requestType = name;
      });
      allTxs = allTxs.concat(data);
    }
  }

  // Sort newest first
  allTxs.sort((a, b) => new Date(b.requested_at) - new Date(a.requested_at));

  const list = document.getElementById('transactionHistoryList');
  list.innerHTML = '';

  if (allTxs.length === 0) {
    list.innerHTML = '<p class="text-gray-500">No transactions yet.</p>';
    return;
  }

  allTxs.forEach(tx => {
    // Format amount
    let amountText = '‚Äî';
    if (tx.requestType === 'deposit' || tx.requestType === 'withdraw') {
      amountText = `${(tx.ugx_amount || 0).toLocaleString()} UGX`;
    } else if (tx.requestType === 'investment') {
      amountText = `${(tx.ugx_amount || 0).toLocaleString()} UGX (${tx.days}d)`;
    } else if (tx.requestType === 'booster') {
      const ugx = (parseFloat(tx.usdt_amount) * UGX_PER_USDT) || 0;
      amountText = `${ugx.toLocaleString()} UGX`;
    }

    // Status color
    let statusColor = 'text-amber-600';
    if (tx.status === 'approved') statusColor = 'text-emerald-600';
    else if (tx.status === 'rejected') statusColor = 'text-red-600';

    const div = document.createElement('div');
    div.className = 'flex justify-between items-start py-1 border-b border-gray-100 dark:border-gray-700 text-xs';
    div.innerHTML = `
      <div>
        <div class="font-medium">${tx.displayType}${tx.requestType === 'booster' ? ': ' + tx.booster_type : ''}</div>
        <div class="${statusColor} capitalize">${tx.status || 'pending'}</div>
      </div>
      <div class="text-right">
        <div>${amountText}</div>
        <button onclick="viewReceipt('${tx.receipt_id}', '${tx.requestType}')" 
                class="text-blue-500 text-xs mt-1 underline">View Receipt</button>
      </div>
    `;
    list.appendChild(div);
  });
}

// ‚úÖ FIXED: REAL RECEIPT FROM SUPABASE
async function viewReceipt(receiptId, requestType) {
  if (!receiptId || !requestType) {
    alert("Invalid receipt");
    return;
  }

  const tableName = `${requestType}_requests`;
  const { data, error } = await _supabase
    .from(tableName)
    .select('*')
    .eq('receipt_id', receiptId)
    .maybeSingle();

  if (error || !data) {
    alert("Receipt not found in " + tableName);
    return;
  }

  // Format date
  const formatDate = new Date(data.requested_at).toLocaleString();

  // Format amount based on type
  let amountText = '‚Äî';
  if (requestType === 'deposit' || requestType === 'withdraw') {
    amountText = `${(data.ugx_amount || 0).toLocaleString()} UGX`;
  } else if (requestType === 'investment') {
    amountText = `${(data.ugx_amount || 0).toLocaleString()} UGX ‚Üí ${(data.ugx_return || 0).toLocaleString()} UGX`;
  } else if (requestType === 'booster') {
    const ugx = (parseFloat(data.usdt_amount) * UGX_PER_USDT).toFixed(0);
    amountText = `${ugx} UGX (~${data.usdt_amount} USDT)`;
  }

  // Status color
  let statusColor = 'text-amber-600';
  if (data.status === 'approved') statusColor = 'text-emerald-600';
  else if (data.status === 'rejected') statusColor = 'text-red-600';

  // Admin-provided reason (or fallback)
  const reason = data.reason ||
    (data.status === 'approved' ? 'Approved by admin' :
     data.status === 'rejected' ? 'Rejected by admin' : 'Pending review');

  // Type labels
  const typeLabels = {
    deposit: 'Deposit',
    withdraw: 'Withdrawal',
    investment: 'Investment',
    booster: 'Booster Purchase'
  };

  document.getElementById('receiptContent').innerHTML = `
    <div><strong>Receipt ID:</strong> ${receiptId}</div>
    <div><strong>Type:</strong> ${typeLabels[requestType] || requestType}</div>
    <div><strong>Amount:</strong> ${amountText}</div>
    <div><strong>Status:</strong> <span class="${statusColor}">${data.status}</span></div>
    <div><strong>Date:</strong> ${formatDate}</div>
    <div><strong>TX ID:</strong> ${data.txid || '‚Äî'}</div>
    <div><strong>Reason:</strong> ${reason}</div>
  `;
  document.getElementById('receiptModal').classList.remove('hidden');
}

function printReceipt() {
const printContent = document.getElementById('receiptContent').innerHTML;
const originalBody = document.body.innerHTML;
document.body.innerHTML = `
<div style="padding: 20px; max-width: 500px; margin: auto; font-family: Arial, sans-serif;">
<h2 style="text-align:center; color:#10b981; margin-bottom:20px;">UGX Mine - Receipt</h2>
${printContent.replace(/class="[^"]*"/g, '')}
<div style="margin-top:30px; text-align:center; font-size:12px; color:#666;">
Thank you for using UGX Mine!
</div>
</div>
`;
window.print();
document.body.innerHTML = originalBody;
location.reload(); // restore full app after print
}
async function loadDashboard() {
['UserName', 'UserEmail', 'UserId'].forEach(key => {
const el1 = document.getElementById(`profile${key}`);
const el2 = document.getElementById(`profile${key}2`);
const val = user[key === 'UserName' ? 'username' : key === 'UserEmail' ? 'user_email' : 'user_id'];
if (el1) el1.textContent = val;
if (el2) el2.textContent = val;
});
document.getElementById('profileUserId').textContent = "ID: " + user.user_id;
document.getElementById('profileUserId2').textContent = "ID: " + user.user_id;
const refLink = `${window.location.origin}${window.location.pathname}?ref=${user.username}`;
document.getElementById('refLink').value = refLink;
updateHomeDashboard();
startTimer();
switchTab('home');
}
async function restoreSession() {
const saved = localStorage.getItem('ugxmine_session');
if (!saved) return false;
try {
const { username, password } = JSON.parse(saved);
const { data } = await _supabase.from('users').select('*').eq('username', username).eq('password', password).maybeSingle();
if (data) { user = data; return true; }
} catch (e) {}
localStorage.removeItem('ugxmine_session');
return false;
}
// INIT
(async () => {
const hasSession = await restoreSession();
if (hasSession && user) {
document.getElementById('authCard').classList.add('hidden');
document.getElementById('mainApp').classList.remove('hidden');
loadDashboard();
}
})();
</script>
</body>
</html>
